(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const v of i)if(v.type==="childList")for(const T of v.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&t(T)}).observe(document,{childList:!0,subtree:!0});function f(i){const v={};return i.integrity&&(v.integrity=i.integrity),i.referrerpolicy&&(v.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?v.credentials="include":i.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function t(i){if(i.ep)return;i.ep=!0;const v=f(i);fetch(i.href,v)}})();const _t=document.querySelector("body > nav"),U=document.querySelector("main > canvas"),yt=document.querySelector("input[name=color]"),Ct=document.querySelector("input[name=width]"),Kt=document.querySelector("input[name=scale]"),nt=document.querySelector("body > dialog"),vt=document.querySelector("span.brush"),it=Array.from(document.querySelectorAll("template")).reduce((r,u)=>({...r,[u.id]:(f,t={})=>{f.className=u.id,f.innerHTML="",f.appendChild(u.content.cloneNode(!0)),Object.keys(t).forEach(i=>{const v=f.querySelector(i);if(v){const T=t[i];typeof T=="function"?T(v):v.innerText=T}})}}),{});function bt(r){const{pageX:u,pageY:f}=r instanceof TouchEvent?r.changedTouches[0]:r,t=U.getBoundingClientRect(),i=t.width/U.offsetWidth;return{x:(u-t.left)/i,y:(f-t.top)/i}}function Qt(){it.drawing(_t),document.querySelectorAll("[hidden]").forEach(r=>r.removeAttribute("hidden"))}function zt(r,u,f){it.buying(_t,{"button.buy":t=>t.addEventListener("click",u),"button.cancel":t=>t.addEventListener("click",f),"button.buy > span":r.toLocaleString()})}function Ot(r,u,f,t){const i=(r+(t||"")).toString().includes("%");if(typeof r=="string"?[r,u,f,t]=r.match(/(0?\.?\d{1,3})%?\b/g).map(v=>Number(v)):t!==void 0&&(t=Number.parseFloat(t)),typeof r!="number"||typeof u!="number"||typeof f!="number"||r>255||u>255||f>255)throw new TypeError("Expected three numbers below 256");if(typeof t=="number"){if(!i&&t>=0&&t<=1)t=Math.round(255*t);else if(i&&t>=0&&t<=100)t=Math.round(255*t/100);else throw new TypeError(`Expected alpha value (${t}) as a fraction or percentage`);t=(t|1<<8).toString(16).slice(1)}else t="";return(f|u<<8|r<<16|1<<24).toString(16).slice(1)+t}function Jt(r,u,f){const{data:t}=r.getImageData(u,f,1,1),[i,v,T]=t;return Ot(i,v,T)}function Dt(r,u){const f=r[u],t=r[u+1],i=r[u+2];return Ot(f,t,i)}function Wt(r,u){const f={};for(let t=0;t<u.data.length;t+=4){const i=Dt(u.data,t);if(Dt(r.data,t)!==i){const T=t/4;f[i]?f[i].push(T):f[i]=[T]}}return f}const xt=r=>new Promise(u=>setTimeout(u,r)),Gt=(r,u)=>new Promise(f=>u==null?void 0:u.addEventListener(r,f,{once:!0}));async function Tt(r,u){const f=await window.fetch(`${r}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(u)});if(f.ok){const t=await f.json();return console.log(r,t),t}else{const t=await f.text();throw new Error(`${f.status}: ${t||f.statusText}`)}}Kt.addEventListener("input",function(){const r=Number(this.value),u=U.parentElement;r===1?(u==null||u.classList.remove("scaled"),U.style.transform=""):(u==null||u.classList.add("scaled"),U.style.transform=`scale(${r})`),At()});function At(){const{width:r}=U.getBoundingClientRect(),f=r/U.offsetWidth*Number(Ct.value),t=Math.max(f,16);vt.style.width=`${t}px`,vt.style.margin=`-${t/2}px 0 0 -${t/2}px`}At();Ct.addEventListener("change",At);U.addEventListener("mousemove",r=>{vt.removeAttribute("hidden"),vt.style.left=`${r.clientX}px`,vt.style.top=`${r.clientY}px`});U.addEventListener("touchmove",()=>{vt.setAttribute("hidden","hidden")},{passive:!0});function Yt(r,u){if(r==null)return{};var f={},t=Object.keys(r),i,v;for(v=0;v<t.length;v++)i=t[v],!(u.indexOf(i)>=0)&&(f[i]=r[i]);return f}function st(){return st=Object.assign?Object.assign.bind():function(r){for(var u=1;u<arguments.length;u++){var f=arguments[u];for(var t in f)Object.prototype.hasOwnProperty.call(f,t)&&(r[t]=f[t])}return r},st.apply(this,arguments)}var It={exports:{}};(function(r,u){var f=function(){var t=function(w,C){var d=236,p=17,o=w,x=v[C],n=null,e=0,m=null,g=[],y={},k=function(s,l){e=o*4+17,n=function(a){for(var c=new Array(a),h=0;h<a;h+=1){c[h]=new Array(a);for(var b=0;b<a;b+=1)c[h][b]=null}return c}(e),P(0,0),P(e-7,0),P(0,e-7),W(),z(),j(s,l),o>=7&&Z(s),m==null&&(m=at(o,x,g)),G(m,l)},P=function(s,l){for(var a=-1;a<=7;a+=1)if(!(s+a<=-1||e<=s+a))for(var c=-1;c<=7;c+=1)l+c<=-1||e<=l+c||(0<=a&&a<=6&&(c==0||c==6)||0<=c&&c<=6&&(a==0||a==6)||2<=a&&a<=4&&2<=c&&c<=4?n[s+a][l+c]=!0:n[s+a][l+c]=!1)},$=function(){for(var s=0,l=0,a=0;a<8;a+=1){k(!0,a);var c=O.getLostPoint(y);(a==0||s>c)&&(s=c,l=a)}return l},z=function(){for(var s=8;s<e-8;s+=1)n[s][6]==null&&(n[s][6]=s%2==0);for(var l=8;l<e-8;l+=1)n[6][l]==null&&(n[6][l]=l%2==0)},W=function(){for(var s=O.getPatternPosition(o),l=0;l<s.length;l+=1)for(var a=0;a<s.length;a+=1){var c=s[l],h=s[a];if(n[c][h]==null)for(var b=-2;b<=2;b+=1)for(var L=-2;L<=2;L+=1)b==-2||b==2||L==-2||L==2||b==0&&L==0?n[c+b][h+L]=!0:n[c+b][h+L]=!1}},Z=function(s){for(var l=O.getBCHTypeNumber(o),a=0;a<18;a+=1){var c=!s&&(l>>a&1)==1;n[Math.floor(a/3)][a%3+e-8-3]=c}for(var a=0;a<18;a+=1){var c=!s&&(l>>a&1)==1;n[a%3+e-8-3][Math.floor(a/3)]=c}},j=function(s,l){for(var a=x<<3|l,c=O.getBCHTypeInfo(a),h=0;h<15;h+=1){var b=!s&&(c>>h&1)==1;h<6?n[h][8]=b:h<8?n[h+1][8]=b:n[e-15+h][8]=b}for(var h=0;h<15;h+=1){var b=!s&&(c>>h&1)==1;h<8?n[8][e-h-1]=b:h<9?n[8][15-h-1+1]=b:n[8][15-h-1]=b}n[e-8][8]=!s},G=function(s,l){for(var a=-1,c=e-1,h=7,b=0,L=O.getMaskFunction(l),M=e-1;M>0;M-=2)for(M==6&&(M-=1);;){for(var K=0;K<2;K+=1)if(n[c][M-K]==null){var Y=!1;b<s.length&&(Y=(s[b]>>>h&1)==1);var _=L(c,M-K);_&&(Y=!Y),n[c][M-K]=Y,h-=1,h==-1&&(b+=1,h=7)}if(c+=a,c<0||e<=c){c-=a,a=-a;break}}},V=function(s,l){for(var a=0,c=0,h=0,b=new Array(l.length),L=new Array(l.length),M=0;M<l.length;M+=1){var K=l[M].dataCount,Y=l[M].totalCount-K;c=Math.max(c,K),h=Math.max(h,Y),b[M]=new Array(K);for(var _=0;_<b[M].length;_+=1)b[M][_]=255&s.getBuffer()[_+a];a+=K;var tt=O.getErrorCorrectPolynomial(Y),et=F(b[M],tt.getLength()-1),Bt=et.mod(tt);L[M]=new Array(tt.getLength()-1);for(var _=0;_<L[M].length;_+=1){var Mt=_+Bt.getLength()-L[M].length;L[M][_]=Mt>=0?Bt.getAt(Mt):0}}for(var Lt=0,_=0;_<l.length;_+=1)Lt+=l[_].totalCount;for(var wt=new Array(Lt),dt=0,_=0;_<c;_+=1)for(var M=0;M<l.length;M+=1)_<b[M].length&&(wt[dt]=b[M][_],dt+=1);for(var _=0;_<h;_+=1)for(var M=0;M<l.length;M+=1)_<L[M].length&&(wt[dt]=L[M][_],dt+=1);return wt},at=function(s,l,a){for(var c=I.getRSBlocks(s,l),h=Q(),b=0;b<a.length;b+=1){var L=a[b];h.put(L.getMode(),4),h.put(L.getLength(),O.getLengthInBits(L.getMode(),s)),L.write(h)}for(var M=0,b=0;b<c.length;b+=1)M+=c[b].dataCount;if(h.getLengthInBits()>M*8)throw"code length overflow. ("+h.getLengthInBits()+">"+M*8+")";for(h.getLengthInBits()+4<=M*8&&h.put(0,4);h.getLengthInBits()%8!=0;)h.putBit(!1);for(;!(h.getLengthInBits()>=M*8||(h.put(d,8),h.getLengthInBits()>=M*8));)h.put(p,8);return V(h,c)};y.addData=function(s,l){l=l||"Byte";var a=null;switch(l){case"Numeric":a=R(s);break;case"Alphanumeric":a=E(s);break;case"Byte":a=q(s);break;case"Kanji":a=J(s);break;default:throw"mode:"+l}g.push(a),m=null},y.isDark=function(s,l){if(s<0||e<=s||l<0||e<=l)throw s+","+l;return n[s][l]},y.getModuleCount=function(){return e},y.make=function(){if(o<1){for(var s=1;s<40;s++){for(var l=I.getRSBlocks(s,x),a=Q(),c=0;c<g.length;c++){var h=g[c];a.put(h.getMode(),4),a.put(h.getLength(),O.getLengthInBits(h.getMode(),s)),h.write(a)}for(var b=0,c=0;c<l.length;c++)b+=l[c].dataCount;if(a.getLengthInBits()<=b*8)break}o=s}k(!1,$())},y.createTableTag=function(s,l){s=s||2,l=typeof l>"u"?s*4:l;var a="";a+='<table style="',a+=" border-width: 0px; border-style: none;",a+=" border-collapse: collapse;",a+=" padding: 0px; margin: "+l+"px;",a+='">',a+="<tbody>";for(var c=0;c<y.getModuleCount();c+=1){a+="<tr>";for(var h=0;h<y.getModuleCount();h+=1)a+='<td style="',a+=" border-width: 0px; border-style: none;",a+=" border-collapse: collapse;",a+=" padding: 0px; margin: 0px;",a+=" width: "+s+"px;",a+=" height: "+s+"px;",a+=" background-color: ",a+=y.isDark(c,h)?"#000000":"#ffffff",a+=";",a+='"/>';a+="</tr>"}return a+="</tbody>",a+="</table>",a},y.createSvgTag=function(s,l,a,c){var h={};typeof arguments[0]=="object"&&(h=arguments[0],s=h.cellSize,l=h.margin,a=h.alt,c=h.title),s=s||2,l=typeof l>"u"?s*4:l,a=typeof a=="string"?{text:a}:a||{},a.text=a.text||null,a.id=a.text?a.id||"qrcode-description":null,c=typeof c=="string"?{text:c}:c||{},c.text=c.text||null,c.id=c.text?c.id||"qrcode-title":null;var b=y.getModuleCount()*s+l*2,L,M,K,Y,_="",tt;for(tt="l"+s+",0 0,"+s+" -"+s+",0 0,-"+s+"z ",_+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',_+=h.scalable?"":' width="'+b+'px" height="'+b+'px"',_+=' viewBox="0 0 '+b+" "+b+'" ',_+=' preserveAspectRatio="xMinYMin meet"',_+=c.text||a.text?' role="img" aria-labelledby="'+ft([c.id,a.id].join(" ").trim())+'"':"",_+=">",_+=c.text?'<title id="'+ft(c.id)+'">'+ft(c.text)+"</title>":"",_+=a.text?'<description id="'+ft(a.id)+'">'+ft(a.text)+"</description>":"",_+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',_+='<path d="',K=0;K<y.getModuleCount();K+=1)for(Y=K*s+l,L=0;L<y.getModuleCount();L+=1)y.isDark(K,L)&&(M=L*s+l,_+="M"+M+","+Y+tt);return _+='" stroke="transparent" fill="black"/>',_+="</svg>",_},y.createDataURL=function(s,l){s=s||2,l=typeof l>"u"?s*4:l;var a=y.getModuleCount()*s+l*2,c=l,h=a-l;return D(a,a,function(b,L){if(c<=b&&b<h&&c<=L&&L<h){var M=Math.floor((b-c)/s),K=Math.floor((L-c)/s);return y.isDark(K,M)?0:1}else return 1})},y.createImgTag=function(s,l,a){s=s||2,l=typeof l>"u"?s*4:l;var c=y.getModuleCount()*s+l*2,h="";return h+="<img",h+=' src="',h+=y.createDataURL(s,l),h+='"',h+=' width="',h+=c,h+='"',h+=' height="',h+=c,h+='"',a&&(h+=' alt="',h+=ft(a),h+='"'),h+="/>",h};var ft=function(s){for(var l="",a=0;a<s.length;a+=1){var c=s.charAt(a);switch(c){case"<":l+="&lt;";break;case">":l+="&gt;";break;case"&":l+="&amp;";break;case'"':l+="&quot;";break;default:l+=c;break}}return l},Ut=function(s){var l=1;s=typeof s>"u"?l*2:s;var a=y.getModuleCount()*l+s*2,c=s,h=a-s,b,L,M,K,Y,_={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},tt={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},et="";for(b=0;b<a;b+=2){for(M=Math.floor((b-c)/l),K=Math.floor((b+1-c)/l),L=0;L<a;L+=1)Y="\u2588",c<=L&&L<h&&c<=b&&b<h&&y.isDark(M,Math.floor((L-c)/l))&&(Y=" "),c<=L&&L<h&&c<=b+1&&b+1<h&&y.isDark(K,Math.floor((L-c)/l))?Y+=" ":Y+="\u2588",et+=s<1&&b+1>=h?tt[Y]:_[Y];et+=`
`}return a%2&&s>0?et.substring(0,et.length-a-1)+Array(a+1).join("\u2580"):et.substring(0,et.length-1)};return y.createASCII=function(s,l){if(s=s||1,s<2)return Ut(l);s-=1,l=typeof l>"u"?s*2:l;var a=y.getModuleCount()*s+l*2,c=l,h=a-l,b,L,M,K,Y=Array(s+1).join("\u2588\u2588"),_=Array(s+1).join("  "),tt="",et="";for(b=0;b<a;b+=1){for(M=Math.floor((b-c)/s),et="",L=0;L<a;L+=1)K=1,c<=L&&L<h&&c<=b&&b<h&&y.isDark(M,Math.floor((L-c)/s))&&(K=0),et+=K?Y:_;for(M=0;M<s;M+=1)tt+=et+`
`}return tt.substring(0,tt.length-1)},y.renderTo2dContext=function(s,l){l=l||2;for(var a=y.getModuleCount(),c=0;c<a;c++)for(var h=0;h<a;h++)s.fillStyle=y.isDark(c,h)?"black":"white",s.fillRect(c*l,h*l,l,l)},y};t.stringToBytesFuncs={default:function(w){for(var C=[],d=0;d<w.length;d+=1){var p=w.charCodeAt(d);C.push(p&255)}return C}},t.stringToBytes=t.stringToBytesFuncs.default,t.createStringToBytes=function(w,C){var d=function(){for(var o=S(w),x=function(){var z=o.read();if(z==-1)throw"eof";return z},n=0,e={};;){var m=o.read();if(m==-1)break;var g=x(),y=x(),k=x(),P=String.fromCharCode(m<<8|g),$=y<<8|k;e[P]=$,n+=1}if(n!=C)throw n+" != "+C;return e}(),p="?".charCodeAt(0);return function(o){for(var x=[],n=0;n<o.length;n+=1){var e=o.charCodeAt(n);if(e<128)x.push(e);else{var m=d[o.charAt(n)];typeof m=="number"?(m&255)==m?x.push(m):(x.push(m>>>8),x.push(m&255)):x.push(p)}}return x}};var i={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3},v={L:1,M:0,Q:3,H:2},T={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},O=function(){var w=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],C=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,d=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,p=1<<14|1<<12|1<<10|1<<4|1<<1,o={},x=function(n){for(var e=0;n!=0;)e+=1,n>>>=1;return e};return o.getBCHTypeInfo=function(n){for(var e=n<<10;x(e)-x(C)>=0;)e^=C<<x(e)-x(C);return(n<<10|e)^p},o.getBCHTypeNumber=function(n){for(var e=n<<12;x(e)-x(d)>=0;)e^=d<<x(e)-x(d);return n<<12|e},o.getPatternPosition=function(n){return w[n-1]},o.getMaskFunction=function(n){switch(n){case T.PATTERN000:return function(e,m){return(e+m)%2==0};case T.PATTERN001:return function(e,m){return e%2==0};case T.PATTERN010:return function(e,m){return m%3==0};case T.PATTERN011:return function(e,m){return(e+m)%3==0};case T.PATTERN100:return function(e,m){return(Math.floor(e/2)+Math.floor(m/3))%2==0};case T.PATTERN101:return function(e,m){return e*m%2+e*m%3==0};case T.PATTERN110:return function(e,m){return(e*m%2+e*m%3)%2==0};case T.PATTERN111:return function(e,m){return(e*m%3+(e+m)%2)%2==0};default:throw"bad maskPattern:"+n}},o.getErrorCorrectPolynomial=function(n){for(var e=F([1],0),m=0;m<n;m+=1)e=e.multiply(F([1,A.gexp(m)],0));return e},o.getLengthInBits=function(n,e){if(1<=e&&e<10)switch(n){case i.MODE_NUMBER:return 10;case i.MODE_ALPHA_NUM:return 9;case i.MODE_8BIT_BYTE:return 8;case i.MODE_KANJI:return 8;default:throw"mode:"+n}else if(e<27)switch(n){case i.MODE_NUMBER:return 12;case i.MODE_ALPHA_NUM:return 11;case i.MODE_8BIT_BYTE:return 16;case i.MODE_KANJI:return 10;default:throw"mode:"+n}else if(e<41)switch(n){case i.MODE_NUMBER:return 14;case i.MODE_ALPHA_NUM:return 13;case i.MODE_8BIT_BYTE:return 16;case i.MODE_KANJI:return 12;default:throw"mode:"+n}else throw"type:"+e},o.getLostPoint=function(n){for(var e=n.getModuleCount(),m=0,g=0;g<e;g+=1)for(var y=0;y<e;y+=1){for(var k=0,P=n.isDark(g,y),$=-1;$<=1;$+=1)if(!(g+$<0||e<=g+$))for(var z=-1;z<=1;z+=1)y+z<0||e<=y+z||$==0&&z==0||P==n.isDark(g+$,y+z)&&(k+=1);k>5&&(m+=3+k-5)}for(var g=0;g<e-1;g+=1)for(var y=0;y<e-1;y+=1){var W=0;n.isDark(g,y)&&(W+=1),n.isDark(g+1,y)&&(W+=1),n.isDark(g,y+1)&&(W+=1),n.isDark(g+1,y+1)&&(W+=1),(W==0||W==4)&&(m+=3)}for(var g=0;g<e;g+=1)for(var y=0;y<e-6;y+=1)n.isDark(g,y)&&!n.isDark(g,y+1)&&n.isDark(g,y+2)&&n.isDark(g,y+3)&&n.isDark(g,y+4)&&!n.isDark(g,y+5)&&n.isDark(g,y+6)&&(m+=40);for(var y=0;y<e;y+=1)for(var g=0;g<e-6;g+=1)n.isDark(g,y)&&!n.isDark(g+1,y)&&n.isDark(g+2,y)&&n.isDark(g+3,y)&&n.isDark(g+4,y)&&!n.isDark(g+5,y)&&n.isDark(g+6,y)&&(m+=40);for(var Z=0,y=0;y<e;y+=1)for(var g=0;g<e;g+=1)n.isDark(g,y)&&(Z+=1);var j=Math.abs(100*Z/e/e-50)/5;return m+=j*10,m},o}(),A=function(){for(var w=new Array(256),C=new Array(256),d=0;d<8;d+=1)w[d]=1<<d;for(var d=8;d<256;d+=1)w[d]=w[d-4]^w[d-5]^w[d-6]^w[d-8];for(var d=0;d<255;d+=1)C[w[d]]=d;var p={};return p.glog=function(o){if(o<1)throw"glog("+o+")";return C[o]},p.gexp=function(o){for(;o<0;)o+=255;for(;o>=256;)o-=255;return w[o]},p}();function F(w,C){if(typeof w.length>"u")throw w.length+"/"+C;var d=function(){for(var o=0;o<w.length&&w[o]==0;)o+=1;for(var x=new Array(w.length-o+C),n=0;n<w.length-o;n+=1)x[n]=w[n+o];return x}(),p={};return p.getAt=function(o){return d[o]},p.getLength=function(){return d.length},p.multiply=function(o){for(var x=new Array(p.getLength()+o.getLength()-1),n=0;n<p.getLength();n+=1)for(var e=0;e<o.getLength();e+=1)x[n+e]^=A.gexp(A.glog(p.getAt(n))+A.glog(o.getAt(e)));return F(x,0)},p.mod=function(o){if(p.getLength()-o.getLength()<0)return p;for(var x=A.glog(p.getAt(0))-A.glog(o.getAt(0)),n=new Array(p.getLength()),e=0;e<p.getLength();e+=1)n[e]=p.getAt(e);for(var e=0;e<o.getLength();e+=1)n[e]^=A.gexp(A.glog(o.getAt(e))+x);return F(n,0).mod(o)},p}var I=function(){var w=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],C=function(o,x){var n={};return n.totalCount=o,n.dataCount=x,n},d={},p=function(o,x){switch(x){case v.L:return w[(o-1)*4+0];case v.M:return w[(o-1)*4+1];case v.Q:return w[(o-1)*4+2];case v.H:return w[(o-1)*4+3];default:return}};return d.getRSBlocks=function(o,x){var n=p(o,x);if(typeof n>"u")throw"bad rs block @ typeNumber:"+o+"/errorCorrectionLevel:"+x;for(var e=n.length/3,m=[],g=0;g<e;g+=1)for(var y=n[g*3+0],k=n[g*3+1],P=n[g*3+2],$=0;$<y;$+=1)m.push(C(k,P));return m},d}(),Q=function(){var w=[],C=0,d={};return d.getBuffer=function(){return w},d.getAt=function(p){var o=Math.floor(p/8);return(w[o]>>>7-p%8&1)==1},d.put=function(p,o){for(var x=0;x<o;x+=1)d.putBit((p>>>o-x-1&1)==1)},d.getLengthInBits=function(){return C},d.putBit=function(p){var o=Math.floor(C/8);w.length<=o&&w.push(0),p&&(w[o]|=128>>>C%8),C+=1},d},R=function(w){var C=i.MODE_NUMBER,d=w,p={};p.getMode=function(){return C},p.getLength=function(n){return d.length},p.write=function(n){for(var e=d,m=0;m+2<e.length;)n.put(o(e.substring(m,m+3)),10),m+=3;m<e.length&&(e.length-m==1?n.put(o(e.substring(m,m+1)),4):e.length-m==2&&n.put(o(e.substring(m,m+2)),7))};var o=function(n){for(var e=0,m=0;m<n.length;m+=1)e=e*10+x(n.charAt(m));return e},x=function(n){if("0"<=n&&n<="9")return n.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+n};return p},E=function(w){var C=i.MODE_ALPHA_NUM,d=w,p={};p.getMode=function(){return C},p.getLength=function(x){return d.length},p.write=function(x){for(var n=d,e=0;e+1<n.length;)x.put(o(n.charAt(e))*45+o(n.charAt(e+1)),11),e+=2;e<n.length&&x.put(o(n.charAt(e)),6)};var o=function(x){if("0"<=x&&x<="9")return x.charCodeAt(0)-"0".charCodeAt(0);if("A"<=x&&x<="Z")return x.charCodeAt(0)-"A".charCodeAt(0)+10;switch(x){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+x}};return p},q=function(w){var C=i.MODE_8BIT_BYTE,d=t.stringToBytes(w),p={};return p.getMode=function(){return C},p.getLength=function(o){return d.length},p.write=function(o){for(var x=0;x<d.length;x+=1)o.put(d[x],8)},p},J=function(w){var C=i.MODE_KANJI,d=t.stringToBytesFuncs.SJIS;if(!d)throw"sjis not supported.";(function(x,n){var e=d(x);if(e.length!=2||(e[0]<<8|e[1])!=n)throw"sjis not supported."})("\u53CB",38726);var p=d(w),o={};return o.getMode=function(){return C},o.getLength=function(x){return~~(p.length/2)},o.write=function(x){for(var n=p,e=0;e+1<n.length;){var m=(255&n[e])<<8|255&n[e+1];if(33088<=m&&m<=40956)m-=33088;else if(57408<=m&&m<=60351)m-=49472;else throw"illegal char at "+(e+1)+"/"+m;m=(m>>>8&255)*192+(m&255),x.put(m,13),e+=2}if(e<n.length)throw"illegal char at "+(e+1)},o},N=function(){var w=[],C={};return C.writeByte=function(d){w.push(d&255)},C.writeShort=function(d){C.writeByte(d),C.writeByte(d>>>8)},C.writeBytes=function(d,p,o){p=p||0,o=o||d.length;for(var x=0;x<o;x+=1)C.writeByte(d[x+p])},C.writeString=function(d){for(var p=0;p<d.length;p+=1)C.writeByte(d.charCodeAt(p))},C.toByteArray=function(){return w},C.toString=function(){var d="";d+="[";for(var p=0;p<w.length;p+=1)p>0&&(d+=","),d+=w[p];return d+="]",d},C},H=function(){var w=0,C=0,d=0,p="",o={},x=function(e){p+=String.fromCharCode(n(e&63))},n=function(e){if(!(e<0)){if(e<26)return 65+e;if(e<52)return 97+(e-26);if(e<62)return 48+(e-52);if(e==62)return 43;if(e==63)return 47}throw"n:"+e};return o.writeByte=function(e){for(w=w<<8|e&255,C+=8,d+=1;C>=6;)x(w>>>C-6),C-=6},o.flush=function(){if(C>0&&(x(w<<6-C),w=0,C=0),d%3!=0)for(var e=3-d%3,m=0;m<e;m+=1)p+="="},o.toString=function(){return p},o},S=function(w){var C=w,d=0,p=0,o=0,x={};x.read=function(){for(;o<8;){if(d>=C.length){if(o==0)return-1;throw"unexpected end of file./"+o}var e=C.charAt(d);if(d+=1,e=="=")return o=0,-1;if(e.match(/^\s$/))continue;p=p<<6|n(e.charCodeAt(0)),o+=6}var m=p>>>o-8&255;return o-=8,m};var n=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(e==43)return 62;if(e==47)return 63;throw"c:"+e};return x},B=function(w,C){var d=w,p=C,o=new Array(w*C),x={};x.setPixel=function(g,y,k){o[y*d+g]=k},x.write=function(g){g.writeString("GIF87a"),g.writeShort(d),g.writeShort(p),g.writeByte(128),g.writeByte(0),g.writeByte(0),g.writeByte(0),g.writeByte(0),g.writeByte(0),g.writeByte(255),g.writeByte(255),g.writeByte(255),g.writeString(","),g.writeShort(0),g.writeShort(0),g.writeShort(d),g.writeShort(p),g.writeByte(0);var y=2,k=e(y);g.writeByte(y);for(var P=0;k.length-P>255;)g.writeByte(255),g.writeBytes(k,P,255),P+=255;g.writeByte(k.length-P),g.writeBytes(k,P,k.length-P),g.writeByte(0),g.writeString(";")};var n=function(g){var y=g,k=0,P=0,$={};return $.write=function(z,W){if(z>>>W!=0)throw"length over";for(;k+W>=8;)y.writeByte(255&(z<<k|P)),W-=8-k,z>>>=8-k,P=0,k=0;P=z<<k|P,k=k+W},$.flush=function(){k>0&&y.writeByte(P)},$},e=function(g){for(var y=1<<g,k=(1<<g)+1,P=g+1,$=m(),z=0;z<y;z+=1)$.add(String.fromCharCode(z));$.add(String.fromCharCode(y)),$.add(String.fromCharCode(k));var W=N(),Z=n(W);Z.write(y,P);var j=0,G=String.fromCharCode(o[j]);for(j+=1;j<o.length;){var V=String.fromCharCode(o[j]);j+=1,$.contains(G+V)?G=G+V:(Z.write($.indexOf(G),P),$.size()<4095&&($.size()==1<<P&&(P+=1),$.add(G+V)),G=V)}return Z.write($.indexOf(G),P),Z.write(k,P),Z.flush(),W.toByteArray()},m=function(){var g={},y=0,k={};return k.add=function(P){if(k.contains(P))throw"dup key:"+P;g[P]=y,y+=1},k.size=function(){return y},k.indexOf=function(P){return g[P]},k.contains=function(P){return typeof g[P]<"u"},k};return x},D=function(w,C,d){for(var p=B(w,C),o=0;o<C;o+=1)for(var x=0;x<w;x+=1)p.setPixel(x,o,d(x,o));var n=N();p.write(n);for(var e=H(),m=n.toByteArray(),g=0;g<m.length;g+=1)e.writeByte(m[g]);return e.flush(),"data:image/gif;base64,"+e};return t}();(function(){f.stringToBytesFuncs["UTF-8"]=function(t){function i(v){for(var T=[],O=0;O<v.length;O++){var A=v.charCodeAt(O);A<128?T.push(A):A<2048?T.push(192|A>>6,128|A&63):A<55296||A>=57344?T.push(224|A>>12,128|A>>6&63,128|A&63):(O++,A=65536+((A&1023)<<10|v.charCodeAt(O)&1023),T.push(240|A>>18,128|A>>12&63,128|A>>6&63,128|A&63))}return T}return i(t)}})(),function(t){r.exports=t()}(function(){return f})})(It);const mt=It.exports;/*! qrcanvas v3.1.2 | ISC License */var ct="#000",Pt="#fff",X={createCanvas:Zt,isCanvas:St,isDrawable:Xt,getCanvas:Et,updateCanvas:Vt,drawCanvas:jt,drawText:te};function Zt(r,u){var f=document.createElement("canvas");return f.width=r,f.height=u,f}function St(r){return r instanceof HTMLCanvasElement}function Xt(r){return St(r)||r instanceof HTMLImageElement}function Et(r,u){return X.createCanvas(r,u==null?r:u)}function Vt(r,u,f){return r?(r.width=u,r.height=f==null?u:f,r):Et(u,f)}function jt(r,u,f){f===void 0&&(f={});var t=f,i=t.cellSize,v=t.context,T=t.clear,O=T===void 0?!0:T,A=r.width,F=r.height,I=[u],Q=v||r.getContext("2d");for(O&&Q.clearRect(0,0,A,F),Q.globalCompositeOperation="source-over";I.length;){var R=I.shift();if(Array.isArray(R))I=R.concat(I);else if(R){var E=void 0;X.isDrawable(R)?E={image:R}:typeof R=="string"?E={style:R}:E=R;var q=(E.col==null?E.x:E.col*i)||0,J=(E.row==null?E.y:E.row*i)||0;q<0&&(q+=A),J<0&&(J+=A);var N=("cols"in E?E.cols*i:E.w)||A,H=("rows"in E?E.rows*i:E.h)||A;E.image?Q.drawImage(E.image,q,J,N,H):(Q.fillStyle=E.style||"black",Q.fillRect(q,J,N,H))}}return r}function te(r,u){var f=u||{},t=f.fontSize,i=t===void 0?64:t,v=f.fontStyle,T=v===void 0?"":v,O=f.fontFamily,A=O===void 0?"Cursive":O,F=f.color,I=F===void 0?null:F,Q=f.pad,R=Q===void 0?8:Q,E=f.padColor,q=E===void 0?Pt:E,J=f.mode,N=J===void 0?1:J,H=Et(1),S=H.getContext("2d"),B;if(q){S.fillStyle=q,S.fillRect(0,0,1,1);var D=S.getImageData(0,0,1,1);B=D.data,B[3]||(B=null)}var w=i+2*R,C=[T,i+"px",A].filter(Boolean).join(" "),d=function(){S.textAlign="center",S.textBaseline="middle",S.font=C};d();var p=Math.ceil(S.measureText(r).width)+2*R;H.width=p,H.height=w,d();var o=function(){S.fillStyle=I||ct,S.fillText(r,p/2,w/2)};return N===1?(S.fillStyle=q,S.fillRect(0,0,p,w),o()):(o(),B&&function(){for(var x=S.getImageData(0,0,p,w),n=x.data,e=p*w,m=[],g=0,y=function($){var z=[],W={};m[g]=z,g=1-g;var Z=m[g];if(!Z){Z=[];for(var j=0;j<e;j+=1)Z.push(j)}Z.forEach(function(G){n[4*G+3]&&[G%p?G-1:-1,(G+1)%p?G+1:-1,G-p,G+p].forEach(function(V){var at=4*V;at>=0&&at<=n.length&&!W[V]&&(W[V]=1,z.push(V))})}),z.forEach(function(G){var V=4*G;if(!n[V+3])for(var at=0;at<4;at+=1)n[V+at]=B[at]})},k=0;k<R;k+=1)y();S.putImageData(x,0,0)}()),H}var kt={default:ee,round:re,fusion:ne,spot:ae};function ee(r){var u=r.foreground,f=r.cellSize,t=r.isDark,i=r.count,v=X.getCanvas,T=X.drawCanvas,O=f*i,A=v(O),F=A.getContext("2d");F.fillStyle=ct,ht({cellSize:f,count:i},function(R){var E=R.i,q=R.j,J=R.x,N=R.y;t(E,q)&&F.fillRect(J,N,f,f)});var I=v(O);T(I,u,{cellSize:f});var Q=I.getContext("2d");return Q.globalCompositeOperation="destination-in",Q.drawImage(A,0,0),I}function re(r,u){var f=r.foreground,t=r.cellSize,i=r.isDark,v=r.count,T=X.getCanvas,O=X.drawCanvas,A=t*v,F=T(A),I=u.value,Q=I===void 0?1:I,R=Q*t/2,E=F.getContext("2d");E.fillStyle=ct,ht({cellSize:t,count:v},function(N){var H=N.i,S=N.j,B=N.x,D=N.y;i(H,S)&&(E.beginPath(),E.moveTo(B+.5*t,D),ot(E,B+t,D,B+t,D+.5*t,R),ot(E,B+t,D+t,B+.5*t,D+t,R),ot(E,B,D+t,B,D+.5*t,R),ot(E,B,D,B+.5*t,D,R),E.fill())});var q=T(A);O(q,f,{cellSize:t});var J=q.getContext("2d");return J.globalCompositeOperation="destination-in",J.drawImage(F,0,0),q}function ne(r,u){var f=r.foreground,t=r.cellSize,i=r.isDark,v=r.count,T=X.getCanvas,O=X.drawCanvas,A=t*v,F=T(A),I=F.getContext("2d");I.fillStyle=ct;var Q=u.value,R=Q===void 0?1:Q,E=R*t/2;ht({cellSize:t,count:v},function(N){var H=N.i,S=N.j,B=N.x,D=N.y,w=[0,0,0,0];i(H-1,S)&&(w[0]+=1,w[1]+=1),i(H+1,S)&&(w[2]+=1,w[3]+=1),i(H,S-1)&&(w[0]+=1,w[3]+=1),i(H,S+1)&&(w[1]+=1,w[2]+=1),i(H,S)?(i(H-1,S-1)&&(w[0]+=1),i(H-1,S+1)&&(w[1]+=1),i(H+1,S+1)&&(w[2]+=1),i(H+1,S-1)&&(w[3]+=1),I.beginPath(),I.moveTo(B+.5*t,D),ot(I,B+t,D,B+t,D+.5*t,w[1]?0:E),ot(I,B+t,D+t,B+.5*t,D+t,w[2]?0:E),ot(I,B,D+t,B,D+.5*t,w[3]?0:E),ot(I,B,D,B+.5*t,D,w[0]?0:E),I.fill()):(w[0]===2&&gt(I,B,D+.5*t,B,D,B+.5*t,D,E),w[1]===2&&gt(I,B+.5*t,D,B+t,D,B+t,D+.5*t,E),w[2]===2&&gt(I,B+t,D+.5*t,B+t,D+t,B+.5*t,D+t,E),w[3]===2&&gt(I,B+.5*t,D+t,B,D+t,B,D+.5*t,E))});var q=T(A);O(q,f,{cellSize:t});var J=q.getContext("2d");return J.globalCompositeOperation="destination-in",J.drawImage(F,0,0),q}function ae(r,u){var f=r.foreground,t=r.cellSize,i=r.isDark,v=r.count,T=X.getCanvas,O=X.drawCanvas,A=t*v,F=T(A),I=u.value,Q=u.foregroundLight,R=Q===void 0?Pt:Q,E=F.getContext("2d"),q=T(A),J=T(A),N=q.getContext("2d");return[{dark:!0,foreground:f},{dark:!1,foreground:R}].forEach(function(H){E.fillStyle=ct,E.clearRect(0,0,A,A),ht({cellSize:t,count:v},function(S){var B=S.i,D=S.j,w=S.x,C=S.y;if(i(B,D)^+!H.dark){var d;B<=7&&D<=7||B<=7&&v-D-1<=7||v-B-1<=7&&D<=7||B+5<=v&&B+9>=v&&D+5<=v&&D+9>=v||B===7||D===7?d=1-.1*I:d=.25;var p=(1-d)/2;E.fillRect(w+p*t,C+p*t,d*t,d*t)}}),O(q,H.foreground,{cellSize:t,context:N}),N.globalCompositeOperation="destination-in",N.drawImage(F,0,0),O(J,q,{cellSize:t,clear:!1})}),J}function ht(r,u){for(var f=r.cellSize,t=r.count,i=0;i<t;i+=1)for(var v=0;v<t;v+=1){var T=v*f,O=i*f;u({i,j:v,x:T,y:O})}}function ot(r,u,f,t,i,v){v?r.arcTo(u,f,t,i,v):(r.lineTo(u,f),r.lineTo(t,i))}function gt(r,u,f,t,i,v,T,O){r.beginPath(),r.moveTo(u,f),ot(r,t,i,v,T,O),r.lineTo(t,i),r.lineTo(u,f),r.fill()}mt.stringToBytes=mt.stringToBytesFuncs["UTF-8"];var oe={background:"white",foreground:"black",typeNumber:0,correctLevel:"L",data:"",padding:0,resize:!0},ie=function(){function r(f){var t=this;this.options=st({},oe),this.cache={},this.isDark=function(i,v){var T=t.cache,O=T.qr,A=T.count;return i<0||i>=A||v<0||v>=A?!1:O.isDark(i,v)},this.setOptions(f)}var u=r.prototype;return u.render=function(t,i){i===void 0&&(i={});var v=this.options,T=v.background,O=v.foreground,A=v.padding,F=v.effect,I=v.logo,Q=v.resize,R=kt[F.type]||kt.default,E=this.cache.count,q=X.drawCanvas,J=i,N=J.size,H,S,B;{var D=i,w=D.cellSize;!t&&!w&&!N&&(w=6),w&&(N=E*w+A+A),N?H=Q||!t?X.updateCanvas(t,N):t:(N=t.width,H=t)}var C=N-A-A;{var d=Math.ceil(C/E),p=d*E;if(S=X.getCanvas(d*E),q(S,T,{cellSize:d}),B=R(st({foreground:O,cellSize:d,isDark:this.isDark},this.cache),this.options.effect),I){var o=st({},I);if(!I.w&&!I.h&&!I.cols&&!I.rows){var x=I.image,n=x.width,e=x.height,m=n/e,g=Math.min((E-18)/E,.38),y=Math.min(e,p*g,p*g/m),k=y*m,P=(p-k)/2,$=(p-y)/2;o.w=k,o.h=y,o.x=P,o.y=$}q(B,o,{clear:!1})}}return q(H,[{image:S},{image:B,x:A,y:A,w:C,h:C}]),H},u.setOptions=function(t){this.options=st({},this.options,t),this.normalizeEffect(),this.normalizeLogo();var i=this.options,v=i.typeNumber,T=i.data,O=i.logo,A=this.options.correctLevel;O&&["Q","H"].indexOf(A)<0&&(A="H");var F=mt(v,A);F.addData(T||""),F.make();var I=F.getModuleCount();this.cache={qr:F,count:I}},u.normalizeEffect=function(){var t=this.options.effect;typeof t=="string"&&(t={type:t}),this.options.effect=t||{}},u.normalizeLogo=function(){var t=X.isDrawable,i=X.drawText,v=this.options.logo;v&&(t(v)?v={image:v}:t(v.image)||(typeof v=="string"&&(v={text:v}),typeof v.text=="string"?v={image:i(v.text,v.options)}:v=null)),this.options.logo=v},r}();function ue(r){var u=r.canvas,f=r.size,t=r.cellSize,i=Yt(r,["canvas","size","cellSize"]),v=new ie(i);return v.render(u,{size:f,cellSize:t})}async function fe(r){it.loading(nt),nt.showModal();try{const{purchaseId:u,numPixels:f}=await se(r);it.negotiating(nt,{code:u});const t=nt.querySelector("input"),i=String(f);t.value=i,t.setAttribute("min",i),await Gt("click",nt.querySelector("button.bolt11"));const v=t.value;it.loading(nt);const T=await ve(u,Number(v));console.debug(T.request),it.paying(nt,{pre:T.request,a:O=>O.setAttribute("href",`lightning://${T.request}`),canvas:O=>ue({data:T.request,size:300,canvas:O})}),await xt(1e4),await Rt(T.hash)}catch(u){alert("Something went wrong, check console"),console.error(u),nt.close()}}async function se(r){return console.log("fetchPurchase"),Tt("/purchase",{order:Object.keys(r).map(u=>({color:`#${u}`,pixels:r[u]}))})}async function ve(r,u=1){return console.log("fetchInvoice",r,u),Tt("/payment/create",{purchaseId:r,amount:u})}function le(r){return console.log("checkPayment",r),Tt("/payment/check",{hash:r})}async function Rt(r,u=5e3,f=5){var i;const t=nt.querySelector("p.poll");for(let v=1;v<=f;v++){if(!nt.open)return;t.innerText=`(${v}/${f}) Checking...`;const{paid:T}=await le(r);if(T)return it.loading(nt,{h6:"Payment detected!",small:"The page will reload shortly"}),await xt(1e3),location.reload(),!0;v<f&&(t.innerText=`(${v}/${f}) Not paid yet.`,await xt(u))}return t.innerHTML='Stopped polling. <a href="#">Continue</a>.',(i=t.querySelector("a"))==null||i.addEventListener("click",v=>{v.preventDefault(),Rt(r,u,f*2)},{once:!0}),!1}const rt=Nt(U),lt=new Image;lt.addEventListener("load",$t);function Nt(r){return r.getContext("2d",{willReadFrequently:!0})}function $t(){U.width=lt.width,U.height=lt.height,rt.imageSmoothingEnabled=!1,rt.drawImage(lt,0,0,U.width,U.height),Qt()}let ut=0;function ce(r){const{x:u,y:f}=bt(r);yt.value=`#${Jt(rt,u,f)}`,console.info("picked",yt.value)}function Ft(r){const{x:u,y:f}=bt(r);ut||(console.log("startDrawing",r.type),ut=1,U.classList.add("drawing"),rt.beginPath(),rt.lineWidth=Number(Ct.value),rt.strokeStyle=yt.value,rt.lineCap="round",rt.lineJoin="round",rt.moveTo(u,f))}function Ht(r){if(!ut)return;r.preventDefault(),console.log("doDrawing",r.type),ut++;const{x:u,y:f}=bt(r);rt.lineTo(u,f),rt.stroke()}function pt(r){if(!ut)return;r.preventDefault(),console.log("stopDrawing",r.type),U.classList.remove("drawing"),ut===1&&["touchend","mouseup"].includes(r.type)&&ce(r),ut=0;const u=de(),f=Object.values(u).reduce((t,i)=>t+i.length,0);f&&zt(f,()=>{fe(u)},$t)}function qt(r){return u=>{if(u.touches.length===1)return r(u)}}U.addEventListener("mousedown",Ft);U.addEventListener("mousemove",Ht);U.addEventListener("mouseup",pt);U.addEventListener("mouseleave",pt);U.addEventListener("touchstart",qt(Ft));U.addEventListener("touchmove",qt(Ht));U.addEventListener("touchend",pt);U.addEventListener("touchcancel",pt);function de(){const{height:r,width:u}=U,f=Nt(U.cloneNode());f.drawImage(lt,0,0,r,u);const t=f.getImageData(0,0,r,u),i=rt.getImageData(0,0,r,u);return Wt(t,i)}lt.src="/image.png";
